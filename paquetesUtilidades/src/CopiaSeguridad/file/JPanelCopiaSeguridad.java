/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package CopiaSeguridad.file;

import ListDatos.JFilaDatosDefecto;
import java.io.File;
import javax.swing.JFileChooser;
import main.JDatosGeneralesP;
import utiles.JDepuracion;
import utilesGUIx.JGUIxConfigGlobal;
import utilesGUIx.controlProcesos.JProcesoAccionAbstracX;
import utilesGUIx.formsGenericos.JMostrarPantalla;
import utilesGUIx.formsGenericos.JMostrarPantallaParam;
import utilesGUIx.msgbox.JMsgBox;

/**
 *
 * @author eduardo
 */
public class JPanelCopiaSeguridad extends javax.swing.JPanel {

    /**
     * Creates new form JPanelCopiaSeguridad
     */
    public JPanelCopiaSeguridad() {
        initComponents();
        jComboBoxCZ1.addLinea("Segun fecha fichero", String.valueOf(JFicheroDirec.mclSegunFicheroFecha)+JFilaDatosDefecto.mcsSeparacion1);
        jComboBoxCZ1.addLinea("Sin sobreescribir", String.valueOf(JFicheroDirec.mclSinSobreescribir)+JFilaDatosDefecto.mcsSeparacion1);
        jComboBoxCZ1.addLinea("Sobreescribir", String.valueOf(JFicheroDirec.mclSobreescribir)+JFilaDatosDefecto.mcsSeparacion1);
        jComboBoxCZ1.setValueTabla(String.valueOf(JFicheroDirec.mclSegunFicheroFecha)+JFilaDatosDefecto.mcsSeparacion1);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel25 = new javax.swing.JPanel();
        jLabelCZ27 = new utilesGUIx.JLabelCZ();
        txtRutaOrigen = new utilesGUIx.JTextFieldCZ();
        btnExplorarOrigen = new utilesGUIx.JButtonCZ();
        jPanel26 = new javax.swing.JPanel();
        jLabelCZ28 = new utilesGUIx.JLabelCZ();
        txtRutaDestino = new utilesGUIx.JTextFieldCZ();
        btnExplorarDestino = new utilesGUIx.JButtonCZ();
        jPanel27 = new javax.swing.JPanel();
        jLabelCZ29 = new utilesGUIx.JLabelCZ();
        txtRutaRefer = new utilesGUIx.JTextFieldCZ();
        btnExplorarrefer = new utilesGUIx.JButtonCZ();
        jLabelCZ1 = new utilesGUIx.JLabelCZ();
        jComboBoxCZ1 = new utilesGUIx.JComboBoxCZ();
        jLabelCZ2 = new utilesGUIx.JLabelCZ();
        jTextFieldCZ1 = new utilesGUIx.JTextFieldCZ();
        jButtonCZ1 = new utilesGUIx.JButtonCZ();
        jButtonCZ2 = new utilesGUIx.JButtonCZ();

        setLayout(new java.awt.GridBagLayout());

        jPanel25.setBorder(javax.swing.BorderFactory.createTitledBorder("Ruta origen"));
        jPanel25.setLayout(new java.awt.GridBagLayout());

        jLabelCZ27.setText("ruta");
        jPanel25.add(jLabelCZ27, new java.awt.GridBagConstraints());
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel25.add(txtRutaOrigen, gridBagConstraints);

        btnExplorarOrigen.setText("...");
        btnExplorarOrigen.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExplorarOrigenActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        jPanel25.add(btnExplorarOrigen, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        add(jPanel25, gridBagConstraints);

        jPanel26.setBorder(javax.swing.BorderFactory.createTitledBorder("Ruta destino"));
        jPanel26.setLayout(new java.awt.GridBagLayout());

        jLabelCZ28.setText("ruta");
        jPanel26.add(jLabelCZ28, new java.awt.GridBagConstraints());
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel26.add(txtRutaDestino, gridBagConstraints);

        btnExplorarDestino.setText("...");
        btnExplorarDestino.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExplorarDestinoActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        jPanel26.add(btnExplorarDestino, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        add(jPanel26, gridBagConstraints);

        jPanel27.setBorder(javax.swing.BorderFactory.createTitledBorder("Direc. referencia (opcional) (para hacer copias de seguridad a partir de una mensual, por ejemplo)"));
        jPanel27.setLayout(new java.awt.GridBagLayout());

        jLabelCZ29.setText("ruta");
        jPanel27.add(jLabelCZ29, new java.awt.GridBagConstraints());
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel27.add(txtRutaRefer, gridBagConstraints);

        btnExplorarrefer.setText("...");
        btnExplorarrefer.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExplorarreferActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        jPanel27.add(btnExplorarrefer, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        add(jPanel27, gridBagConstraints);

        jLabelCZ1.setText("Accion sobre ficheros existentes");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        add(jLabelCZ1, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        add(jComboBoxCZ1, gridBagConstraints);

        jLabelCZ2.setText("Ficheros a excluir (*.tif;*.jpg)");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        add(jLabelCZ2, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        add(jTextFieldCZ1, gridBagConstraints);

        jButtonCZ1.setText("Aceptar");
        jButtonCZ1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCZ1ActionPerformed(evt);
            }
        });
        add(jButtonCZ1, new java.awt.GridBagConstraints());

        jButtonCZ2.setText("Cancelar");
        jButtonCZ2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCZ2ActionPerformed(evt);
            }
        });
        add(jButtonCZ2, new java.awt.GridBagConstraints());
    }// </editor-fold>//GEN-END:initComponents

    private void btnExplorarOrigenActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExplorarOrigenActionPerformed
        File loFile = null;
        try{
            JFileChooser loFileM = new JFileChooser();
            loFileM.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            if(loFileM.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
                loFile = loFileM.getSelectedFile();
                txtRutaOrigen.setText(loFile.getAbsolutePath());
            }
        }catch(Exception e){
            JDepuracion.anadirTexto(getClass().getName(), e);
            utilesGUIx.msgbox.JMsgBox.mensajeError(this, e.toString());
        }
    }//GEN-LAST:event_btnExplorarOrigenActionPerformed

    private void btnExplorarDestinoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExplorarDestinoActionPerformed
        File loFile = null;
        try{
            JFileChooser loFileM = new JFileChooser();
            loFileM.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            if(loFileM.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
                loFile = loFileM.getSelectedFile();
                txtRutaDestino.setText(loFile.getAbsolutePath());
            }
        }catch(Exception e){
            JDepuracion.anadirTexto(getClass().getName(), e);
            utilesGUIx.msgbox.JMsgBox.mensajeError(this, e.toString());
        }
    }//GEN-LAST:event_btnExplorarDestinoActionPerformed

    private void jButtonCZ2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonCZ2ActionPerformed
        
        JGUIxConfigGlobal.getInstancia().getMostrarPantalla().cerrarForm(this);
        
    }//GEN-LAST:event_jButtonCZ2ActionPerformed

    private void jButtonCZ1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonCZ1ActionPerformed
        try{
           JDatosGeneralesP.getDatosGenerales().getThreadGroup().addProcesoYEjecutar(new JProcesoAccionAbstracX() {

                public String getTitulo() {
                    return "Copia seguridad";
                }

                public int getNumeroRegistros() {
                    return -1;
                }

                public void procesar() throws Throwable {
                    JCopiaSeguridad.main(new String[]{
                        txtRutaOrigen.getText(), txtRutaDestino.getText()
                        , jComboBoxCZ1.getFilaActual().msCampo(0).equals(String.valueOf(JFicheroDirec.mclSinSobreescribir))
                            ? "-n" 
                            : jComboBoxCZ1.getFilaActual().msCampo(0).equals(String.valueOf(JFicheroDirec.mclSobreescribir))
                            ? "-s" 
                            : "-f"
                        , jTextFieldCZ1.getText().equals("") ? "" : "-e"
                            , jTextFieldCZ1.getText()
                        , txtRutaRefer.getText().trim().equals("") 
                            ? ""
                            : "-r"
                        , txtRutaRefer.getText()

                    });
                }

                public String getTituloRegistroActual() {
                    return "";
                }

                public void mostrarMensaje(String psMensaje) {
                    JMsgBox.mensajeInformacion(null, psMensaje);
                }
            });
            
            JGUIxConfigGlobal.getInstancia().getMostrarPantalla().cerrarForm(this);
        }catch(Exception e){
            JDepuracion.anadirTexto(getClass().getName(), e);
            utilesGUIx.msgbox.JMsgBox.mensajeError(this, e.toString());
        }
        

    }//GEN-LAST:event_jButtonCZ1ActionPerformed

    private void btnExplorarreferActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExplorarreferActionPerformed
        File loFile = null;
        try{
            JFileChooser loFileM = new JFileChooser();
            loFileM.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
            if(loFileM.showOpenDialog(this) == JFileChooser.APPROVE_OPTION) {
                loFile = loFileM.getSelectedFile();
                txtRutaRefer.setText(loFile.getAbsolutePath());
            }
        }catch(Exception e){
            JDepuracion.anadirTexto(getClass().getName(), e);
            utilesGUIx.msgbox.JMsgBox.mensajeError(this, e.toString());
        }
    }//GEN-LAST:event_btnExplorarreferActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private utilesGUIx.JButtonCZ btnExplorarDestino;
    private utilesGUIx.JButtonCZ btnExplorarOrigen;
    private utilesGUIx.JButtonCZ btnExplorarrefer;
    private utilesGUIx.JButtonCZ jButtonCZ1;
    private utilesGUIx.JButtonCZ jButtonCZ2;
    private utilesGUIx.JComboBoxCZ jComboBoxCZ1;
    private utilesGUIx.JLabelCZ jLabelCZ1;
    private utilesGUIx.JLabelCZ jLabelCZ2;
    private utilesGUIx.JLabelCZ jLabelCZ27;
    private utilesGUIx.JLabelCZ jLabelCZ28;
    private utilesGUIx.JLabelCZ jLabelCZ29;
    private javax.swing.JPanel jPanel25;
    private javax.swing.JPanel jPanel26;
    private javax.swing.JPanel jPanel27;
    private utilesGUIx.JTextFieldCZ jTextFieldCZ1;
    private utilesGUIx.JTextFieldCZ txtRutaDestino;
    private utilesGUIx.JTextFieldCZ txtRutaOrigen;
    private utilesGUIx.JTextFieldCZ txtRutaRefer;
    // End of variables declaration//GEN-END:variables
}
