/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package ejecTipo;

import java.io.File;
import javax.swing.JFileChooser;
import utiles.config.JDatosGeneralesXML;
import utilesGUI.tiposTextos.JTipoTextoEstandar;
import utilesGUIx.msgbox.JMsgBox;

/**
 *
 * @author eduardo
 */
public class JFormOpciones extends javax.swing.JFrame {
    private JT2Listado moControlador;
    private JDatosGeneralesXML moDatos;

    /**
     * Creates new form JFormOpciones
     */
    public JFormOpciones() {
        initComponents();
        txtZ.setTipo(JTipoTextoEstandar.mclTextNumeroEntero);
    }
    
    public void setDatos(JT2Listado poControlador, JDatosGeneralesXML poDatos){
        moControlador=poControlador;
        moDatos=poDatos;
        
        txtZ.setValueTabla(moDatos.getPropiedad(JDatosGenerales.mcsZ, "1"));
        txtExtensiones.setValueTabla(moDatos.getPropiedad(JDatosGenerales.mcsExtensiones, "rom"));
        txtRUTAEjecutable.setValueTabla(moDatos.getPropiedad(JDatosGenerales.mcsRutaEje, "fmsx-dos.exe"));
        txtRuta.setValueTabla(moDatos.getPropiedad(JDatosGenerales.mcsRuta, "."));
        
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel1 = new javax.swing.JPanel();
        jLabelCZ1 = new utilesGUIx.JLabelCZ();
        txtRuta = new utilesGUIx.JTextFieldCZ();
        btnRuta = new utilesGUIx.JButtonCZ();
        jLabelCZ2 = new utilesGUIx.JLabelCZ();
        txtExtensiones = new utilesGUIx.JTextFieldCZ();
        jLabelCZ3 = new utilesGUIx.JLabelCZ();
        txtZ = new utilesGUIx.JTextFieldCZ();
        jPanel2 = new javax.swing.JPanel();
        jLabelCZ4 = new utilesGUIx.JLabelCZ();
        txtRUTAEjecutable = new utilesGUIx.JTextFieldCZ();
        btnRutaEje = new utilesGUIx.JButtonCZ();
        jPanel3 = new javax.swing.JPanel();
        btnAceptar = new utilesGUIx.JButtonCZ();
        btnCancelar = new utilesGUIx.JButtonCZ();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Opciones");
        getContentPane().setLayout(new java.awt.GridBagLayout());

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder("Ficheros a buscar"));
        jPanel1.setLayout(new java.awt.GridBagLayout());

        jLabelCZ1.setText("Ruta:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel1.add(jLabelCZ1, gridBagConstraints);

        txtRuta.setMinimumSize(new java.awt.Dimension(100, 25));
        txtRuta.setPreferredSize(new java.awt.Dimension(100, 25));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel1.add(txtRuta, gridBagConstraints);

        btnRuta.setText("...");
        btnRuta.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRutaActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel1.add(btnRuta, gridBagConstraints);

        jLabelCZ2.setText("Extensiones:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel1.add(jLabelCZ2, gridBagConstraints);

        txtExtensiones.setMinimumSize(new java.awt.Dimension(100, 25));
        txtExtensiones.setPreferredSize(new java.awt.Dimension(100, 25));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel1.add(txtExtensiones, gridBagConstraints);

        jLabelCZ3.setText("Profundidad busqueda:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel1.add(jLabelCZ3, gridBagConstraints);

        txtZ.setMinimumSize(new java.awt.Dimension(100, 25));
        txtZ.setPreferredSize(new java.awt.Dimension(100, 25));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel1.add(txtZ, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        getContentPane().add(jPanel1, gridBagConstraints);

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder("Ejecutable"));
        jPanel2.setLayout(new java.awt.GridBagLayout());

        jLabelCZ4.setText("Ejecutable:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel2.add(jLabelCZ4, gridBagConstraints);

        txtRUTAEjecutable.setMinimumSize(new java.awt.Dimension(100, 25));
        txtRUTAEjecutable.setPreferredSize(new java.awt.Dimension(100, 25));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel2.add(txtRUTAEjecutable, gridBagConstraints);

        btnRutaEje.setText("...");
        btnRutaEje.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRutaEjeActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel2.add(btnRutaEje, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        getContentPane().add(jPanel2, gridBagConstraints);

        btnAceptar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/ejecTipo/accept.gif"))); // NOI18N
        btnAceptar.setText("Aceptar");
        btnAceptar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAceptarActionPerformed(evt);
            }
        });
        jPanel3.add(btnAceptar);

        btnCancelar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/ejecTipo/cancel.gif"))); // NOI18N
        btnCancelar.setText("Cancelar");
        btnCancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCancelarActionPerformed(evt);
            }
        });
        jPanel3.add(btnCancelar);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        getContentPane().add(jPanel3, gridBagConstraints);

        setBounds(0, 0, 410, 330);
    }// </editor-fold>//GEN-END:initComponents

    private void btnCancelarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCancelarActionPerformed
        
        dispose();
        
    }//GEN-LAST:event_btnCancelarActionPerformed

    private void btnAceptarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAceptarActionPerformed
        
        try{
            moDatos.setPropiedad(JDatosGenerales.mcsZ, txtZ.getText());
            moDatos.setPropiedad(JDatosGenerales.mcsExtensiones, txtExtensiones.getText());
            moDatos.setPropiedad(JDatosGenerales.mcsRutaEje, txtRUTAEjecutable.getText());
            moDatos.setPropiedad(JDatosGenerales.mcsRuta, txtRuta.getText());
            moDatos.guardarFichero();
            
            moControlador.refrescar();
            
            dispose();
        }catch(Exception e){
            JMsgBox.mensajeErrorYLog(this, e);
        }
    }//GEN-LAST:event_btnAceptarActionPerformed

    private void btnRutaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRutaActionPerformed

        JFileChooser fileChooser = new JFileChooser();
        String ruta = txtRuta.getText();
        fileChooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
        fileChooser.setCurrentDirectory(new File(txtRuta.getText()));
        int returnVal = fileChooser.showOpenDialog(this);
        if(returnVal == JFileChooser.APPROVE_OPTION) {
           ruta = fileChooser.getSelectedFile().getAbsolutePath();    
        }
        if (ruta != null && !ruta.equals(""))
            txtRuta.setValueTabla(ruta);

    }//GEN-LAST:event_btnRutaActionPerformed

    private void btnRutaEjeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRutaEjeActionPerformed
        JFileChooser fileChooser = new JFileChooser();
        String ruta = txtRUTAEjecutable.getText();
        fileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);
        fileChooser.setCurrentDirectory(new File(txtRUTAEjecutable.getText()));
        int returnVal = fileChooser.showOpenDialog(this);
        if(returnVal == JFileChooser.APPROVE_OPTION) {
           ruta = fileChooser.getSelectedFile().getAbsolutePath();    
        }
        if (ruta != null && !ruta.equals(""))
            txtRUTAEjecutable.setValueTabla(ruta);

    }//GEN-LAST:event_btnRutaEjeActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private utilesGUIx.JButtonCZ btnAceptar;
    private utilesGUIx.JButtonCZ btnCancelar;
    private utilesGUIx.JButtonCZ btnRuta;
    private utilesGUIx.JButtonCZ btnRutaEje;
    private utilesGUIx.JLabelCZ jLabelCZ1;
    private utilesGUIx.JLabelCZ jLabelCZ2;
    private utilesGUIx.JLabelCZ jLabelCZ3;
    private utilesGUIx.JLabelCZ jLabelCZ4;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private utilesGUIx.JTextFieldCZ txtExtensiones;
    private utilesGUIx.JTextFieldCZ txtRUTAEjecutable;
    private utilesGUIx.JTextFieldCZ txtRuta;
    private utilesGUIx.JTextFieldCZ txtZ;
    // End of variables declaration//GEN-END:variables
}
